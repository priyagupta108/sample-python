name: Reproduce Issue #851

on:
  push:
    branches: [ "issue-851" ]
 
jobs:
  run_master:
    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
        os: [ubuntu-latest]
        python: ['3.9']

    steps:
    - uses: actions/checkout@v3
      with:
        fetch-depth: 0
        
    - name: Set up Python
      uses: actions/setup-python@v3
      with:
        python-version: ${{ matrix.python }}
        
    - name: venv activate
      run: |
        python -m venv test-venv
        echo 'VIRTUAL_ENV=test-venv' >> $GITHUB_ENV
        echo 'PATH=test-venv/bin:$PATH' >> $GITHUB_ENV
        source test-venv/bin/activate
        echo "VIRTUAL_ENV: $VIRTUAL_ENV"

    - name: Print PATH after append
      run: echo $PATH    
